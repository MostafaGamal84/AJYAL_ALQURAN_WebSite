import { CommonModule } from '@angular/common';
import {
  AfterViewInit,
  ChangeDetectorRef,
  Component,
  OnInit
} from '@angular/core';
import { HttpClient } from '@angular/common/http';
import Swiper from 'swiper';
import { Navigation, Pagination, Autoplay } from 'swiper/modules';
Swiper.use([Navigation, Pagination, Autoplay]);
@Component({
  selector: 'app-packages',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './packages.component.html',
  styleUrl: './packages.component.css',
})
export class PackagesComponent implements OnInit, AfterViewInit {

   packages: any[] = [
  {
    title: '✨ قسم الحفظ المُيسَّر في أجيال القرآن ✨',
    content: `🔸 التعريف:
قسم الحفظ المُيسَّر هو أحد أكثر الأقسام انتشارًا في أجيال القرآن، لكونه الأنسب لأغلب الطلاب، سواءً من أصحاب المستوى المتوسط أو الطلاب المنشغلين، ويُعنى بحفظ القرآن الكريم بطريقة مريحة ومتدرجة، مع العناية بالتجويد وفهم المعاني المجملة وغريب القرآن.
🔹 الفئة المستهدفة:
الطالب العادي متوسط المستوى.
الطالب المنشغل الذي لا يستطيع الالتحاق ببرامج الحفظ المكثفة.
🎯 أهداف قسم الحفظ المُيسَّر:
ترغيب الطلاب في حفظ القرآن الكريم دون مشقة أو ضغط.
بناء علاقة حب وطمأنينة مع كلام الله تعالى.
تأسيس قاعدة متينة في الحفظ المستمر والمتقن.
تحسين النطق والتجويد ومخارج الحروف.
فهم غريب القرآن والمعاني العامة للآيات.
تثبيت المحفوظ عبر مراجعات منتظمة ومدروسة.
🧩 تقسيمة الحلقة في قسم الحفظ المُيسَّر:
⏱ مدة الحلقة:
من 20 إلى 60 دقيقة، بحسب الباقة التعليمية التي التحق بها الطالب.
ماسية   ذهبية    فضية   برونزية
📌 الأوراد داخل الحلقة:
تنقسم الحصة إلى أربعة أوراد رئيسية، مع العناية بالتجويد وغريب القرآن:
الجديد:
الآيات الجديدة التي يبدأ الطالب بحفظها في هذا اللقاء.
الماضي القريب:
ما تم حفظه خلال الأسبوع الحالي أو السابق.
الماضي البعيد:
مراجعة أجزاء أو سور تم حفظها قبل فترة متوسطة.
الماضي الأبعد:
مراجعة السور أو الأجزاء التي تم حفظها منذ وقت طويل لتثبيت المحفوظ.
🧪 اختبارات دورية:
تُجرى اختبارات تقويمية دورية للاطمئنان على جودة الحفظ وتميّز الأداء، وتُستخدم النتائج في توجيه الطالب ومتابعته.`
  },
  {
    title: '🎙 قسم الترديد 🎙',
    content: `🔸 التعريف:
قسم الترديد هو قسم تعليمي في أجيال القرآن يعتمد على أسلوب التلقين والتكرار، حيث يُردّد الطالب الآيات خلف المعلم عدة مرات حتى يترسخ الحفظ في الذهن عن طريق الذاكرة السمعية، مع تصحيح مخارج الحروف والنطق السليم.
🔹 الفئة المستهدفة:
الأطفال في المراحل الأولى من التعلم.
كبار السن.
من يجدون صعوبة في الحفظ البصري أو القراءة.
المبتدئون في طريق الحفظ.
🎯 أهداف قسم الترديد:
تسهيل الحفظ عبر السماع والتكرار.
تصحيح النطق وتحسين الأداء الصوتي.
غرس الثقة في نفس الطالب في نطق القرآن.
بناء أساس سليم للانتقال إلى الحفظ المستقل.
ربط الطالب بجماليات صوت القرآن وتجويده.
🧩 تقسيمة الحلقة في قسم الترديد:
⏱ مدة الحلقة:
من 20 إلى 60 دقيقة، حسب باقة الطالب ومستواه.
📌 المكونات الأساسية للحلقة:
ترديد الآيات الجديدة خلف المعلم. مع تصحيح النطق.
ربط الآيات الجديدة بالمحفوظ السابق.
تحفيز مستمر وتشجيع إيجابي.
واجب سمعي منزلي أو تسجيل صوتي للآيات.
🎧 الوسائل المساعدة:
تسجيلات صوتية بصوت المعلّم.
بطاقات تلوين قرآنية (للفئة العمرية الصغيرة).
سبورة ذكية أو مقاطع مرئية لتشجيع الاستماع.`
  },
  {
    title: '🧱 قسم التأسيس في أجيال القرآن 🧱',
    content: `🔸 التعريف:
قسم التأسيس هو القسم التعليمي المخصَّص لـ بناء المهارات القرآنية الأساسية لدى الطالب، ويُعنى بتعليم الحروف الهجائية، وضبط مخارجها وصفاتها، وقواعد التهجئة، والقراءة السليمة من المصحف، ليكون الطالب مؤهلاً للحفظ أو التلاوة أو التدبر في المراحل التالية.
🔹 الفئة المستهدفة:
الأطفال من عمر 4 سنوات فما فوق.
المبتدئون في تعلم القرآن من جميع الأعمار.
من لديهم ضعف في القراءة أو لم يسبق لهم دراسة التهجي والتجويد.
الراغبون في تصحيح التلاوة من جذورها.
🎯 أهداف قسم التأسيس:
تمكين الطالب من قراءة القرآن الكريم قراءة صحيحة.
تعريف الطالب بالحروف ومخارجها وصفاتها.
تدريب الطالب على التهجي والتركيب القرآني.
إزالة رهبة القراءة من المصحف.
إعداد الطالب للانطلاق في الحفظ أو التلاوة أو التفسير.
🧩 تقسيمة الحلقة في قسم التأسيس:
⏱ مدة الحلقة:
من 30 إلى 60 دقيقة، حسب مستوى الطالب وباقة الاشتراك.
📌 المكونات الأساسية للحلقة:
تعليم الحروف ومخارجها:
تدريب شفوي وعملي على نطق الحروف.
التهجي القرآني:
تهجي الكلمات وتطبيقها على آيات قصيرة من المصحف.
القراءة المتدرجة:
من الحرف إلى الكلمة، ثم إلى الجملة، ثم إلى الآية.
تصحيح التلاوة:
تصحيح النطق والأداء في التلاوة العمليّة.
تثبيت المهارة:
تكرار وتطبيق وتقييم مباشر.
🎒 الوسائل التعليمية المقترحة:
بطاقات الحروف الملونة.
كتب تأسيسية متدرجة (مثل القاعدة النورانية / نور البيان).
سبورة ذكية أو تطبيقات مرئية داعمة.
مقاطع فيديو مبسطة للحروف والحركات.`
  },
  {
    title: '🛡 قسم الحُصون في أجيال القرآن 🛡',
    content: `🔸 التعريف:
قسم الحصون هو أحد الأقسام المنهجية في أجيال القرآن، يُعنى بـ الحفظ المنضبط لكتاب الله تعالى وفق نظام الحصون الخمسة، الذي يضمن للطالب إتقان الحفظ، والثبات عليه، وبناء شبكة مراجعة متكاملة.
🔹 الفئة المستهدفة:
الطلاب الجادّون في بناء حفظ متين ومنظم.
من حفظوا قدرًا من القرآن ويريدون إتقانه.
المقبلون على ختمة أو اختبار أو إجازة.
المعلّمون والمعلّمات الراغبون في ترسيخ الحفظ لدى طلابهم بأسلوب علمي.
🧱 الحصون الخمسة في هذا القسم:
حصن الجديد:
وهو الحفظ اليومي الجديد الذي يبدأ به الطالب.
حصن الماضي القريب:
مراجعة المحفوظ خلال الأسبوع الجاري.
حصن الماضي البعيد:
مراجعة الأجزاء التي مرّ عليها وقت طويل.
حصن التحضير:
تحضير الآيات قبل الحفظ أو التسميع.
حصن القراءة والسماع:
قراءة من المصحف أو سماع تلاوة.
🎯 أهداف قسم الحصون:
ترسيخ الحفظ في الذهن والقلب عبر التكرار.
بناء خطة مراجعة متكاملة.
منع النسيان والضعف في المحفوظ.
تهيئة الطالب لحفظ مستقر.
🧩 تقسيمة الحلقة:
⏱ 30 إلى 100 دقيقة.
📌 المحتوى:
تسميع الجديد، مراجعة الماضي، التحضير، القراءة أو السماع.
🎖 أدوات: جدول، اختبار شهري، وسام الطالب الحصين.`
  },
  {
    title: '🌿 نظام الحفظ والتدبر في أجيال القرآن 🌿',
    content: `🔸 التعريف:
نظام الحفظ والتدبر هو نظام يجمع بين إتقان الحفظ ومعايشة المعنى، حيث لا يُكتفى بتكرار الآيات وحفظها، بل يتم الوقوف على معانيها الإجمالية، وألفاظها الغريبة، ورسائلها التربوية والإيمانية.
🔹 الفئة المستهدفة:
الطلاب الذين أتموا مرحلة التأسيس.
الراغبون في ربط الحفظ بالفهم والعمل.
🎯 الأهداف:
الجمع بين الحفظ والتدبر.
غرس القيم القرآنية وتطبيقها في الواقع.
فهم وجداني، سلوك عملي.
🧩 تقسيمة الحلقة:
⏱ 45 إلى 60 دقيقة.
📌 المحتوى:
📖 تهيئة قلبية.
🧠 قراءة وتدبر الآيات.
🔊 الحفظ بعد الفهم.
🗣 تسميع ومراجعة.
📓 واجب تطبيقي.
🧰 أدوات مساعدة: دفتر تدبر، خرائط، أنشطة تفاعلية، تسجيلات.`
  },
  {
  title: '📜 قسم الإجازات والقراءات في أجيال القرآن 📜',
  content: `🔸 التعريف:
قسم الإجازات هو القسم المعنيّ بـ إعداد وتأهيل الطلاب والطالبات لطلب الإجازة القرآنية بالسند المتصل إلى النبي ﷺ، سواء في حفظ القرآن الكريم كاملًا أو في تلاوته برواية معينة، وفق ضوابط علمية ومناهج إتقان، على يد شيوخ مجازين ذوي كفاءة عالية.

🔹 الفئة المستهدفة:
الحفاظ الذين أتموا حفظ القرآن الكريم.
المتقنين لتلاوة القرآن برواية محددة.
طلاب وطالبات العلم الراغبين في نيل الإجازة بالسند.
المعلّمين والمعلّمات الراغبين في الاعتماد بسند قرآني.

🎯 أهداف قسم الإجازات:
1. تخريج طلاب وطالبات مجازين متقنين، بالسند المتصل إلى النبي ﷺ.
2. ترسيخ منهج التلقي الشفهي المحكم، كما ورد عن السلف.
3. رفع كفاءة المعلمين والمعلمات في أداء القرآن وتعليمه.
4. نشر علم الإقراء والإجازة وفق ضوابط أهل الأداء.
5. حفظ السند القرآني، وربط الأجيال بسلسلة القرّاء المتصلة.

🧩 خطوات العمل في قسم الإجازات:
1. 📝 التقديم والقبول:
التحقق من حفظ الطالب الكامل وجودة التلاوة.
إجراء اختبار تمهيدي في الحفظ والتجويد.
2. 📚 مرحلة التحضير:
مراجعة القرآن كاملًا مع التركيز على الضبط والإتقان.
دراسة القواعد الأساسية في التجويد (نظريًا وعمليًا).
تطبيق العملي للتجويد داخل التلاوة.
3. 🎙 مرحلة العرض الكامل:
عرض القرآن كاملًا من الطالب على الشيخ المجيز.
التصحيح والملاحظات الدقيقة.
4. 📜 مرحلة الإجازة:
إذا أتم الطالب العرض بدرجة الإتقان، يُمنح إجازة مكتوبة مختومة، يُذكر فيها:
الرواية أو القراءات المجاز بها.
اسم الشيخ المجيز وسنده المتصل.
اسم الطالب وتاريخ الإجازة.

📌 ملاحظات مهمة:
يتم اعتماد الإجازات فقط من مشايخ ثقات ذوي سند صحيح.
تُحفظ نُسخ من الإجازات ضمن أرشيف أجيال القرآن.
بعض الإجازات تُرفق معها شهادة إلكترونية للتوثيق الرقمي.

🏅 مخرجات القسم:
مجازون ومجازات في رواية حفص أو غيرها.
مجازون بالسند في عدة قراءات للمتقدّمين.
كوادر تعليمية مؤهلة لإقراء غيرهم.`
}
];

  swiper: Swiper | null = null;

  constructor(private cdr: ChangeDetectorRef, private http: HttpClient) {}

  ngOnInit(): void {}

  ngAfterViewInit(): void {
    this.initializeSwiper();
  }

  initializeSwiper(): void {
  setTimeout(() => {
    if (this.swiper) {
      this.swiper.destroy(true, true);
    }

    this.swiper = new Swiper('.swiper-container', {
      slidesPerView: 1,
      spaceBetween: 20,
       centeredSlides: false,
      loop: false,

      // autoplay: {
      //   delay: 1000, // ← يمر كل ثانية
      //   disableOnInteraction: false, // ← لا يتوقف إذا لمس المستخدم السلايدر
      //   pauseOnMouseEnter: true      // ← يتوقف عند المرور بالماوس (اختياري)
      // },

      pagination: {
        el: '.swiper-pagination',
        clickable: true
      },

      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      },

      breakpoints: {
        640: { slidesPerView: 1 },
        768: { slidesPerView: 2 },
        1024: { slidesPerView: 3 }
      }
    });
  }, 100);
}

  formatContent(text: string): string {
    const lines = text.split('\n');

    const htmlLines = lines.map(line => {
      if (line.startsWith('🔸')) return `<h4 class="section-heading">التعريف:</h4>`;
      if (line.startsWith('🔹')) return `<h4 class="section-heading">الفئة المستهدفة:</h4>`;
      if (line.startsWith('🎯')) return `<h4 class="section-heading">الأهداف:</h4>`;
      if (line.startsWith('🧩')) return `<h4 class="section-heading">تقسيمة الحلقة:</h4>`;
      if (line.startsWith('📌')) return `<h4 class="section-heading">المحتوى:</h4>`;
      if (line.startsWith('⏱')) return `<p class="section-sub"><strong>⏱ المدة:</strong> ${line.replace('⏱ ', '')}</p>`;
      if (line.startsWith('🎧')) return `<h4 class="section-heading">الوسائل المساعدة:</h4>`;
      if (line.startsWith('🎒')) return `<h4 class="section-heading">الوسائل التعليمية:</h4>`;
      if (line.startsWith('🧰')) return `<h4 class="section-heading">أدوات مساعدة:</h4>`;
      if (line.startsWith('📓')) return `<h4 class="section-heading">واجب تطبيقي:</h4>`;
      if (line.startsWith('🗣')) return `<h4 class="section-heading">التسميع والمراجعة:</h4>`;
      if (line.startsWith('🔊')) return `<h4 class="section-heading">الحفظ:</h4>`;
      if (line.startsWith('🧠')) return `<h4 class="section-heading">التدبر:</h4>`;
      if (line.startsWith('📖')) return `<h4 class="section-heading">التهيئة:</h4>`;
      if (line.startsWith('🎖')) return `<h4 class="section-heading">أدوات التقييم:</h4>`;
      if (line.startsWith('🧪')) return `<h4 class="section-heading">الاختبارات:</h4>`;
      if (line.startsWith('🧱')) return `<h4 class="section-heading">الحصون:</h4>`;
      if (line.startsWith('ماسية')) return `<p><strong>الباقات:</strong> ${line}</p>`;

      return `<p>${line}</p>`;
    });

    return htmlLines.join('');
  }
}
